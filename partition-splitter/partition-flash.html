<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Partition Flash Cards</title>

  <!-- Handwritten-style fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@600&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Schoolbell&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Gloria+Hallelujah&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Shadows+Into+Light&display=swap" rel="stylesheet" />

  <style>
    :root {
      --ink: #111827;
      --accent: #2563eb;
      --paper: #fdfcf7;
      --button-bg: #ffffff;
      --button-border: #111827;
      --reveal-green: #0b6623;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: #e5e7eb;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 24px;
      font-family: "Patrick Hand", "Kalam", "Caveat", system-ui, -apple-system,
        BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    .app {
      width: 100%;
      max-width: 960px;
      background: var(--paper);
      border-radius: 24px;
      box-shadow: 0 8px 24px rgba(15, 23, 42, 0.18);
      padding: 24px 32px 32px;
      border: 2px solid #111827;
      position: relative;
    }

    /* HEADER ------------------------------------------------------ */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 24px;
    }

    .title {
      flex: 1;
      text-align: center;
      font-family: "Gloria Hallelujah", "Patrick Hand", cursive;
      font-size: 2.3rem;
      letter-spacing: 1px;
    }

    .back-btn {
      font-family: inherit;
      font-size: 1rem;
      padding: 6px 16px;
      border-radius: 999px;
      border: 2px solid var(--button-border);
      background: var(--button-bg);
      cursor: pointer;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out;
    }

    .back-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 3px 0 #111827;
    }

    .level-buttons {
      display: flex;
      gap: 8px;
    }

    .level-btn {
      font-family: inherit;
      font-size: 0.95rem;
      padding: 4px 12px;
      border-radius: 999px;
      border: 2px solid var(--button-border);
      background: var(--button-bg);
      cursor: pointer;
      transition: background 0.1s ease-out, transform 0.08s ease-out,
        box-shadow 0.08s ease-out, color 0.1s ease-out;
      white-space: nowrap;
    }

    .level-btn.active {
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 3px 0 #1d4ed8;
      transform: translateY(-1px);
    }

    /* QUESTION ---------------------------------------------------- */
    .question-area {
      margin-top: 8px;
      text-align: center;
      padding: 32px 16px 24px;
    }

    .question-number {
      font-family: "Schoolbell", "Caveat", "Patrick Hand", cursive;
      font-size: 8rem;
      line-height: 1;
      margin-bottom: 8px;
      color: var(--ink);
      transition: color 0.15s ease-out;
    }

    .question-number.revealed-green {
      color: var(--reveal-green);
    }

    .question-sentence {
      font-family: "Patrick Hand", "Schoolbell", cursive;
      font-size: 2.1rem;
      line-height: 1.4;
    }

    .number-span {
      font-family: "Caveat", "Kalam", cursive;
      font-size: 4rem;
      color: var(--accent);
      padding: 0 6px;
    }

    .unknown {
      font-size: 2.5rem;
      padding: 0 8px;
    }

    .revealed {
      text-decoration: underline;
      color: var(--reveal-green);
    }

    /* VISUALS ----------------------------------------------------- */
    .visuals {
      margin-top: 40px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 80px;
      flex-wrap: wrap;
    }

    .visual-block {
      text-align: center;
      min-width: 160px;
    }

    .visual-label {
      font-size: 3rem;
      margin-bottom: 8px;
      color: var(--ink);
      transition: color 0.15s ease-out;
    }

    .visual-label.revealed-green {
      color: var(--reveal-green);
    }

    .unit-image-wrapper {
      width: 120px;
      height: 150px;
      border: 2px dashed #9ca3af;
      border-radius: 16px;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0 auto 8px;
      background: #ffffff;
    }

    .unit-image-wrapper img {
      max-width: 100%;
      max-height: 100%;
    }

    .multiplier {
      font-size: 2.5rem;
      color: var(--ink);
      transition: color 0.15s ease-out;
    }

    .multiplier.revealed-green {
      color: var(--reveal-green);
    }

    /* CONTROLS ---------------------------------------------------- */
    .controls {
      margin-top: 40px;
      display: flex;
      justify-content: center;
      gap: 24px;
      align-items: center;
      flex-wrap: wrap;
    }

    .control-btn {
      font-family: inherit;
      font-size: 1.4rem;
      padding: 10px 30px;
      border-radius: 999px;
      border: 2px solid var(--button-border);
      background: var(--button-bg);
      cursor: pointer;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out,
        background 0.1s ease-out;
    }

    .control-btn.primary {
      background: var(--accent);
      color: #ffffff;
      border-color: var(--accent);
      box-shadow: 0 4px 0 #1d4ed8;
    }

    .control-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 3px 0 rgba(0, 0, 0, 0.35);
    }

    .hint {
      text-align: center;
      margin-top: 12px;
      font-size: 1rem;
      color: #4b5563;
    }

    @media (max-width: 700px) {
      .title {
        font-size: 1.8rem;
      }
      .question-number {
        font-size: 3rem;
      }
      .question-sentence {
        font-size: 1.7rem;
      }
      .number-span,
      .unknown {
        font-size: 2rem;
      }
      .visuals {
        gap: 40px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- HEADER -->
    <div class="header">
      <button class="back-btn" id="backBtn">back</button>

      <div class="title">Partition Flash Cards</div>

      <div class="level-buttons">
        <button class="level-btn active" data-level="1">Level 1</button>
        <button class="level-btn" data-level="2">Level 2</button>
        <button class="level-btn" data-level="3">Level 3</button>
        <button class="level-btn" data-level="4">Mixed</button>
      </div>
    </div>

    <!-- QUESTION -->
    <div class="question-area">
      <div class="question-number" id="questionNumber">---</div>
      <div class="question-sentence">
        <span>is the same as</span>
        <span class="unknown" id="leftValue">?</span>
        <span id="placeLabel">tens</span>
        <span>and</span>
        <span class="unknown" id="rightValue">?</span>
        <span>ones.</span>
      </div>
    </div>

    <!-- VISUALS -->
    <div class="visuals">
      <div class="visual-block">
        <div class="visual-label" id="leftLabelText">? tens</div>
        <div class="unit-image-wrapper">
          <img id="leftImage" src="img-tens.png" alt="left unit" />
        </div>
        <div class="multiplier" id="leftMultiplier">× ?</div>
      </div>

      <div class="visual-block">
        <div class="visual-label" id="rightLabelText">? ones</div>
        <div class="unit-image-wrapper">
          <img id="rightImage" src="img-ones.png" alt="ones" />
        </div>
        <div class="multiplier" id="rightMultiplier">× ?</div>
      </div>
    </div>

    <!-- CONTROLS -->
    <div class="controls">
      <button class="control-btn primary" id="newBtn">new problem</button>
      <button class="control-btn" id="revealBtn">reveal</button>
    </div>
    <div class="hint">
      Press <strong>Space</strong> for a new problem &nbsp;•&nbsp;
      Press <strong>R</strong> to reveal
    </div>

    <!-- FOOTER (fixed properly inside card) -->
    <div style="
      text-align: center;
      margin-top: 30px;
      font-size: 0.9rem;
      color: #555;
    ">
      Images generated using 
      <a href="https://polypad.amplify.com/p" target="_blank" style="color:#2563eb; text-decoration:none;">
        Amplify Polypad
      </a>
    </div>

  </div> <!-- end .app -->

  <script>
    // ---------------- CONFIG -------------------------------------
    const PLACE_SETS = {
      3: ["hundreds", "tens", "ones"],
      4: ["thousands", "hundreds", "tens", "ones"],
      5: ["ten-thousands", "thousands", "hundreds", "tens", "ones"],
      6: ["hundred-thousands", "ten-thousands", "thousands", "hundreds", "tens", "ones"],
    };

    const LEVEL_RULES = {
      1: { digits: 3, splitIndices: [0, 1] },
      2: { digits: 4, splitIndices: [0, 1, 2] },
      3: { digits: 5, splitIndices: [0, 1, 2, 3] },
      4: { digits: 6, splitIndices: [0, 1, 2, 3, 4] },
    };

    const PLACE_IMAGES = {
      "hundred-thousands": "img-hundred-thousands.png",
      "ten-thousands": "img-ten-thousands.png",
      thousands: "img-thousands.png",
      hundreds: "img-hundreds.png",
      tens: "img-tens.png",
      ones: "img-ones.png",
    };

    // ---------------- ELEMENTS -----------------------------------
    const backBtn = document.getElementById("backBtn");
    const levelButtons = document.querySelectorAll(".level-btn");

    const questionNumberEl = document.getElementById("questionNumber");
    const placeLabelEl = document.getElementById("placeLabel");
    const leftValueEl = document.getElementById("leftValue");
    const rightValueEl = document.getElementById("rightValue");

    const leftLabelTextEl = document.getElementById("leftLabelText");
    const rightLabelTextEl = document.getElementById("rightLabelText");
    const leftImageEl = document.getElementById("leftImage");
    const rightImageEl = document.getElementById("rightImage");
    const leftMultiplierEl = document.getElementById("leftMultiplier");
    const rightMultiplierEl = document.getElementById("rightMultiplier");

    const newBtn = document.getElementById("newBtn");
    const revealBtn = document.getElementById("revealBtn");

    // ---------------- STATE --------------------------------------
    let currentLevel = 1;
    let currentQuestion = null; 
    let revealed = false;

    // ---------------- HELPERS ------------------------------------
    function randInt(min, maxInclusive) {
      return Math.floor(Math.random() * (maxInclusive - min + 1)) + min;
    }

    function formatWithSpaces(n) {
      return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
    }

    function chooseLevelConfig(level) {
      if (level !== 4) return LEVEL_RULES[level];
      const pick = randInt(1, 4);
      return LEVEL_RULES[pick];
    }

    function generateQuestion() {
      const config = chooseLevelConfig(currentLevel);
      const digits = config.digits;
      const placeNames = PLACE_SETS[digits];

      const min = 10 ** (digits - 1);
      const max = 10 ** digits - 1;
      const number = randInt(min, max);

      const splitIdx =
        config.splitIndices[randInt(0, config.splitIndices.length - 1)];

      const maxPower = placeNames.length - 1;
      const power = maxPower - splitIdx;
      const base = 10 ** power;

      const leftCount = Math.floor(number / base);
      const rightCount = number % base;
      const placeLabel = placeNames[splitIdx];

      return {
        number,
        digits,
        placeLabel,
        leftCount,
        rightCount,
      };
    }

    function updateUI() {
      if (!currentQuestion) return;

      const { number, placeLabel, leftCount, rightCount } = currentQuestion;

      questionNumberEl.textContent = formatWithSpaces(number);
      questionNumberEl.classList.toggle("revealed-green", revealed);

      placeLabelEl.textContent = placeLabel.replace("-", " ");

      if (!revealed) {
        leftValueEl.textContent = "?";
        rightValueEl.textContent = "?";
        leftValueEl.classList.remove("revealed");
        rightValueEl.classList.remove("revealed");
      } else {
        leftValueEl.textContent = leftCount;
        rightValueEl.textContent = rightCount;
        leftValueEl.classList.add("revealed");
        rightValueEl.classList.add("revealed");
      }

      leftLabelTextEl.textContent =
        (revealed ? leftCount : "?") + " " + placeLabel.replace("-", " ");
      rightLabelTextEl.textContent =
        (revealed ? rightCount : "?") + " ones";

      leftLabelTextEl.classList.toggle("revealed-green", revealed);
      rightLabelTextEl.classList.toggle("revealed-green", revealed);

      const leftImgSrc = PLACE_IMAGES[placeLabel] || PLACE_IMAGES["ones"];
      leftImageEl.src = leftImgSrc;
      rightImageEl.src = PLACE_IMAGES["ones"];

      leftMultiplierEl.textContent = "× " + (revealed ? leftCount : "?");
      rightMultiplierEl.textContent = "× " + (revealed ? rightCount : "?");

      leftMultiplierEl.classList.toggle("revealed-green", revealed);
      rightMultiplierEl.classList.toggle("revealed-green", revealed);
    }

    function newProblem() {
      revealed = false;
      currentQuestion = generateQuestion();
      updateUI();
    }

    function revealAnswer() {
      if (!currentQuestion) return;
      revealed = true;
      updateUI();
    }

    // ---------------- EVENT HANDLERS ------------------------------
    backBtn.addEventListener("click", () => {
      window.location.href = "index.html";
    });

    levelButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const level = Number(btn.dataset.level);
        currentLevel = level;

        levelButtons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");

        newProblem();
      });
    });

    newBtn.addEventListener("click", newProblem);
    revealBtn.addEventListener("click", revealAnswer);

    window.addEventListener("keydown", (e) => {
      if (e.target.tagName === "INPUT" || e.target.tagName === "TEXTAREA") {
        return;
      }

      if (e.code === "Space") {
        e.preventDefault();
        newProblem();
      } else if (e.key === "r" || e.key === "R") {
        e.preventDefault();
        revealAnswer();
      }
    });

    // ---------------- INITIAL ------------------------------------
    newProblem();
  </script>
</body>
</html>
